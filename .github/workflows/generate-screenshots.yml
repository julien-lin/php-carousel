name: Generate Screenshots

on:
  workflow_dispatch:
  push:
    branches:
      - main
    paths:
      - 'example.php'
      - 'src/**'

jobs:
  generate:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.1'
      
      - name: Install dependencies
        run: composer install --no-interaction
      
      - name: Setup demo server
        run: |
          php -S localhost:8000 -t . example.php &
          sleep 5
      
      - name: Install Playwright
        run: |
          npm install -g playwright
          npx playwright install chromium
      
      - name: Generate screenshots
        run: |
          # Create screenshots directory
          mkdir -p docs/images
          
          # Use Playwright to capture screenshots
          # Note: This is a template - you'll need to create a script
          # that navigates to your demo page and captures each carousel
          echo "Screenshot generation script would go here"
      
      - name: Commit screenshots
        if: github.ref == 'refs/heads/main'
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add docs/images/*.png
          git commit -m "docs: Update carousel screenshots" || exit 0
          git push

